<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
   <mapper namespace="com.situ.xuexiao.dao.NoticeDao">
   		<resultMap type="Notice" id="findNotice">
   			<id column="sequenceNO" property="sequenceNO"/>
	  		<result column="ID" property="ID"/>	
	  		<result column="content" property="content"/>	
	  		<result column="title" property="title"/>	
	  		<result column="picture" property="picture"/>	
	  		<result column="postedDate" property="postedDate"/>	
	  		<result column="releasePeople" property="releasePeople"/>	
	  		<result column="postedDate" property="postedDate"/>	
	  		<association property="category" javaType="Category">
	  			<id column="SequenceNO" property="sequenceNO"/>
	  			<result column="categoryID" property="ID"/>
	  			<result column="parentID" property="parentID"/>
	  			<result column="title" property="title"/>
	  		</association>	
	  		<association property="publisher" javaType="Teacher">
	  			<id column="teacherSequenceNO" property="sequenceNO"/>
	  			<result column="teacherID" property="ID"/>
	  			<result column="Name" property="name"/>
	  		</association>	
   		</resultMap>
   		
   		<select id="findAskLeaveCount" resultType="int">
   			SELECT count(*)
			FROM notice AS n INNER JOIN teacher AS t 
			ON n.publisher = t.sequenceNO INNER JOIN category AS c
			ON c.sequenceNO = n.category_id where c.parentID = 26
   		</select>
   		
   		<select id="findTeacherNoticeCount" resultType="int">
   			SELECT count(*)
			FROM notice AS n INNER JOIN teacher AS t 
			ON n.publisher = t.sequenceNO INNER JOIN category AS c
			ON c.sequenceNO = n.category_id where c.parentID = 4 or c.parentID = 26
   		</select>
   		
   		<select id="findAllAskLeavePageBean" parameterType="Map" resultMap="findNotice">
   			SELECT n.sequenceNO,n.ID,n.title,n.content,n.category_id,n.picture,n.postedDate,t.sequenceNO AS teacherSequenceNO,t.ID AS teacherID,t.name,c.ID AS categoryID,c.parentID 
			FROM notice AS n INNER JOIN teacher AS t 
			ON n.publisher = t.sequenceNO INNER JOIN category AS c
			ON c.sequenceNO = n.category_id where c.parentID = 26 limit #{index},#{pageSize}
   		</select>
   		
   		<select id="findTeacherNotice" parameterType="Map" resultMap="findNotice">
   			SELECT n.sequenceNO,n.ID,n.title,n.content,n.category_id,n.picture,n.postedDate,t.sequenceNO AS teacherSequenceNO,t.ID AS teacherID,t.name,c.ID AS categoryID,c.parentID 
			FROM notice AS n INNER JOIN teacher AS t 
			ON n.publisher = t.sequenceNO INNER JOIN category AS c
			ON c.sequenceNO = n.category_id where c.parentID = 4 or c.parentID = 26 limit #{index},#{pageSize}
   		</select>
   		
   		<insert id="addAllNotice" parameterType="Notice">
   			insert into notice(ID,title,content,postedDate,picture,publisher,category_id)
   			values(#{ID},#{title},#{content},#{postedDate},#{picture},#{publisher.sequenceNO},20);
   		</insert>
   		
   		<insert id="addTeacherNotice" parameterType="Notice">
   			insert into notice(ID,title,content,postedDate,picture,publisher,category_id)
   			values(#{ID},#{title},#{content},#{postedDate},#{picture},#{publisher.sequenceNO},21);
   		</insert>
   </mapper>